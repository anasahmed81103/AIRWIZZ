@model AIRWIZZ.Models.BookFlightModel

@{
    ViewData["Title"] = "Book Flight";
}

<section class="booking-page" style="background-color:aliceblue;">
    <div style="padding-top:10%;"></div>
    <div class="booking-container">
        <form asp-action="BookFlightPost" method="post">
            <!-- Hidden Fields -->
            <input type="hidden" asp-for="Flight_Id" />
            <input type="hidden" asp-for="Departure_Id" />
            <input type="hidden" asp-for="Arrival_Id" />
            <input type="hidden" asp-for="Amount" />

            <h2>Passenger Details</h2>
            <div class="form-section">
                <div class="input-group">
                    <label for="First_Name">First Name:</label>
                    <input asp-for="First_Name" type="text" placeholder="First Name" required />
                    <span asp-validation-for="First_Name" class="text-danger"></span>

                    <label for="Last_Name">Last Name:</label>
                    <input asp-for="Last_Name" type="text" placeholder="Last Name" required />
                    <span asp-validation-for="Last_Name" class="text-danger"></span>
                </div>
                <label for="Date_Of_Birth">Date of Birth:</label>
                <input asp-for="Date_Of_Birth" type="date" required />
                <span asp-validation-for="Date_Of_Birth" class="text-danger"></span>

                <label for="Nationality">Nationality:</label>
                <select asp-for="Nationality" required>
                    <option value="" disabled selected>Select your nationality</option>
                    <option value="Afghanistan">Afghanistan</option>
                    <option value="Australia">Australia</option>
                    <option value="Austria">Austria</option>
                    <option value="Bahrain">Bahrain</option>
                    <option value="Bangladesh">Bangladesh</option>
                    <option value="Belgium">Belgium</option>
                    <option value="Bhutan">Bhutan</option>
                    <option value="Bosnia and Herzegovina">Bosnia and Herzegovina</option>
                    <option value="Bulgaria">Bulgaria</option>
                    <option value="Canada">Canada</option>
                    <option value="Croatia">Croatia</option>
                    <option value="Cuba">Cuba</option>
                    <option value="Cyprus">Cyprus</option>
                    <option value="Czech Republic">Czech Republic</option>
                    <option value="Denmark">Denmark</option>
                    <option value="Estonia">Estonia</option>
                    <option value="Fiji">Fiji</option>
                    <option value="Finland">Finland</option>
                    <option value="France">France</option>
                    <option value="Germany">Germany</option>
                    <option value="Greece">Greece</option>
                    <option value="Guatemala">Guatemala</option>
                    <option value="Honduras">Honduras</option>
                    <option value="Hungary">Hungary</option>
                    <option value="Iceland">Iceland</option>
                    <option value="India">India</option>
                    <option value="Iran">Iran</option>
                    <option value="Iraq">Iraq</option>
                    <option value="Ireland">Ireland</option>
                    <option value="Israel">Israel</option>
                    <option value="Italy">Italy</option>
                    <option value="Jamaica">Jamaica</option>
                    <option value="Jordan">Jordan</option>
                    <option value="Kiribati">Kiribati</option>
                    <option value="Kuwait">Kuwait</option>
                    <option value="Latvia">Latvia</option>
                    <option value="Lebanon">Lebanon</option>
                    <option value="Lithuania">Lithuania</option>
                    <option value="Luxembourg">Luxembourg</option>
                    <option value="Maldives">Maldives</option>
                    <option value="Malta">Malta</option>
                    <option value="Marshall Islands">Marshall Islands</option>
                    <option value="Mexico">Mexico</option>
                    <option value="Micronesia">Micronesia</option>
                    <option value="Nepal">Nepal</option>
                    <option value="Netherlands">Netherlands</option>
                    <option value="New Zealand">New Zealand</option>
                    <option value="Norway">Norway</option>
                    <option value="Oman">Oman</option>
                    <option value="Palau">Palau</option>
                    <option value="Panama">Panama</option>
                    <option value="Papua New Guinea">Papua New Guinea</option>
                    <option value="Pakistan">Pakistan</option>
                    <option value="Poland">Poland</option>
                    <option value="Portugal">Portugal</option>
                    <option value="Qatar">Qatar</option>
                    <option value="Romania">Romania</option>
                    <option value="Samoa">Samoa</option>
                    <option value="Saudi Arabia">Saudi Arabia</option>
                    <option value="Slovakia">Slovakia</option>
                    <option value="Slovenia">Slovenia</option>
                    <option value="Solomon Islands">Solomon Islands</option>
                    <option value="Spain">Spain</option>
                    <option value="Sri Lanka">Sri Lanka</option>
                    <option value="Sweden">Sweden</option>
                    <option value="Switzerland">Switzerland</option>
                    <option value="Syria">Syria</option>
                    <option value="Tonga">Tonga</option>
                    <option value="Turkey">Turkey</option>
                    <option value="Tuvalu">Tuvalu</option>
                    <option value="United Arab Emirates">United Arab Emirates</option>
                    <option value="United Kingdom">United Kingdom</option>
                    <option value="United States">United States</option>
                    <option value="Vanuatu">Vanuatu</option>
                    <option value="Yemen">Yemen</option>
                </select>
                <span asp-validation-for="Nationality" class="text-danger"></span>

            </div>

            <div class="form-section">
                <label for="Passport_Number">Passport Number:</label>
                <input asp-for="Passport_Number" type="text" placeholder="Passport Number" required />
                <span asp-validation-for="Passport_Number" class="text-danger"></span>
            </div>


            <h2>Seat Selection</h2>
            <div class="form-section">
                <label for="SeatNumber">Select Seat:</label>
                <select asp-for="SeatNumber" id="SeatNumber" required>
                    @for (int i = 1; i <= 100; i++)
                    {
                            <option value="@i">@i</option>
                    }
                </select>
                <span asp-validation-for="SeatNumber" class="text-danger"></span>

                @if (Model.BookedSeats != null && Model.BookedSeats.Contains(Model.SeatNumber))
                {
                        <span class="text-danger">The seat number you've selected is already booked. Please choose a different one.</span>
                }

                <label for="SeatClassType">Seat Class:</label>
                <select asp-for="SeatClassType" required>
                    <option value="Economy">Economy</option>
                    <option value="Business">Business</option>
                    <option value="FirstClass">First Class</option>
                    <option value="PremiumEconomy">Premium Economy Class</option>
                </select>
                <span asp-validation-for="SeatClassType" class="text-danger"></span>
            </div>

            <h2>Payment Details</h2>
            <div class="form-section">
                <label for="CurrencyType">Currency:</label>
                <select asp-for="CurrencyType" required>
                    <option value="USD">United States Dollar (USD)</option>
                    <option value="EUR">Euro (EUR)</option>
                    <option value="INR">Indian Rupee (INR)</option>
                    <option value="JPY">Japanese Yen (JPY)</option>
                    <option value="CNY">Chinese Yuan (CNY)</option>
                    <option value="AUD">Australian Dollar (AUD)</option>
                    <option value="CAD">Canadian Dollar (CAD)</option>
                    <option value="CHF">Swiss Franc (CHF)</option>
                    <option value="SEK">Swedish Krona (SEK)</option>
                    <option value="NZD">New Zealand Dollar (NZD)</option>
                    <option value="ZAR">South African Rand (ZAR)</option>
                    <option value="SGD">Singapore Dollar (SGD)</option>
                    <option value="MXN">Mexican Peso (MXN)</option>
                    <option value="BRL">Brazilian Real (BRL)</option>
                    <option value="RUB">Russian Ruble (RUB)</option>
                    <option value="HKD">Hong Kong Dollar (HKD)</option>
                    <option value="KRW">South Korean Won (KRW)</option>
                    <option value="TRY">Turkish Lira (TRY)</option>
                    <option value="AED">United Arab Emirates Dirham (AED)</option>
                    <option value="SAR">Saudi Riyal (SAR)</option>
                    <option value="MYR">Malaysian Ringgit (MYR)</option>
                    <option value="PHP">Philippine Peso (PHP)</option>
                    <option value="NOK">Norwegian Krone (NOK)</option>
                    <option value="THB">Thai Baht (THB)</option>
                    <option value="DKK">Danish Krone (DKK)</option>
                    <option value="PKR">Pakistani Rupees (PKR)</option>
                    <option value="GBP">British Pound Sterling (GBP)</option>
                    <option value="LKR">Sri Lankan Rupee (LKR)</option>
                    <option value="BDT">Bangladeshi Taka (BDT)</option>
                    <option value="IRR">Iranian Rial (IRR)</option>
                    <option value="IQD">Iraqi Dinar (IQD)</option>
                    <option value="KWD">Kuwaiti Dinar (KWD)</option>
                    <option value="QAR">Qatari Riyal (QAR)</option>
                    <option value="OMR">Omani Rial (OMR)</option>
                    <option value="EGP">Egyptian Pound (EGP)</option>
                </select>
                <span asp-validation-for="CurrencyType" class="text-danger"></span>

                <label for="PaymentMethodType">Payment Method:</label>
                <select asp-for="PaymentMethodType" required>
                    <option value="CreditCard">Credit Card</option>
                    <option value="DebitCard">Debit Card</option>
                    <option value="PayPal">PayPal</option>
                    <option value="BankTransfer">Bank Transfer</option>
                    <option value="UPI">UPI</option>
                    <option value="MobileWallet">Mobile Wallet</option>
                    <option value="CryptoCurrency">Crypto Currency</option>
                </select>
                <span asp-validation-for="PaymentMethodType" class="text-danger"></span>


                <h3>Payment Gateway</h3>
<div class="payment-gateway">
    <!-- Card Number -->
    <div class="form-section">
        <label for="Card_Number">Card Number:</label>
        <input asp-for="Card_Number" type="text" placeholder="Card Number" maxlength="16" required pattern="\d{13,16}" 
               title="Card number must be between 13 and 16 digits." />
        <span asp-validation-for="Card_Number" class="text-danger"></span>
    </div>

    <!-- Expiry Date -->
    <div class="form-section">
        <label for="ExpiryDate">Expiry Date:</label>
        <input type="month" id="ExpiryDate" min="@DateTime.Now.ToString("yyyy-MM")" required />
        <span class="text-danger" id="expiry-error"></span>
    </div>

    <!-- CVV -->
    <div class="form-section">
        <label for="CVV">CVV:</label>
        <input asp-for="CVV" type="password" placeholder="CVV" maxlength="4" required pattern="\d{3,4}" 
               title="CVV must be 3 or 4 digits." />
        <span asp-validation-for="CVV" class="text-danger"></span>
    </div>
</div>



            </div>



            <button type="submit" class="book-button">Submit Booking</button>
        </form>
    </div>
    <div style="padding-bottom:5%;"></div>
</section>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Get the booked seat numbers from the server-side model
        var bookedSeats = @Html.Raw(Json.Serialize(Model.BookedSeats));

        // Loop through each seat option and disable the booked ones
        var seatOptions = document.querySelectorAll('#SeatNumber option');
        seatOptions.forEach(function(option) {
            var seatNumber = parseInt(option.value);
            if (bookedSeats.includes(seatNumber)) {
                option.disabled = true;
            }
        });
    });
</script>
